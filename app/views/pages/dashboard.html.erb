<h2> Hello, <%= @current_user.first_name %> </h2>
<% if @current_user.host %>
  <!--Add rock Button trigger modal -->
  <button type="button" class="btn btn-primary mb-5" data-bs-toggle="modal" data-bs-target="#addNewRock">
    Add a new rock!
  </button>

  <div>
    <h3> My Rocks </h3>
      <% @current_user.rocks.each do |rock| %>
        <div>
          <h4><%= rock.rock_type %></h4>
          <p> <%= rock.description %></p>
        </div>
        <%= link_to "Delete Rock", rock_path(rock), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"}%>
      <% end %>
  </div>

<% else %>

<% end %>

  <!-- Modal to add new rock -->
<div class="modal fade" id="addNewRock" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="addNewRockLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <%= simple_form_for(@rock) do |f| %>
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="staticBackdropLabel">Add a new rock!</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
            <div class="modal-body">
              <%= f.input :rock_type %>
              <%= f.input :daily_price %>
              <%= f.input :description %>
              <%= f.input :photo, as: :file %>
            </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <%= f.submit "Add Rock" %>
              </div>
          </div>
      <% end %>
  </div>
</div>


<!-- TODO we need to sort where the below code fits in with the above -->
<div>
  <h2>My Rock bookings </h2>
  <% @my_bookings.each do |booking| %>
    <div>
      <% if @current_user.rocks.include?(booking.rock) %>
          <h5> Rock: <%= booking.rock.rock_type %> </h5>
          <p> Start time: <%= booking.start_time %> </p>
          <p> End time: <%= booking.end_time %> </p>
          <p> Renter: <%= booking.user.first_name %> </p>
            <%= link_to "Accept", accept_booking_path(booking), class:"btn btn-success", data: {turbo_method: :patch} %>
            <%= link_to "Decline", decline_booking_path(booking), class:"btn btn-warning", data: {turbo_method: :patch} %>
      <% else %>
      <% end %>
    </div>
  <% end %>
</div>

<div>
  <h2>My Bookings </h2>
  <% @bookings.each do |booking| %>
      <div>
        <h5> Rock: <%= booking.rock.rock_type %> </h5>
        <p> Start time: <%= booking.start_time %> </p>
        <p> End time: <%= booking.end_time %> </p>
        <p> Owner: <%= booking.rock.user.email %> </p>
        <%= link_to "Delete", booking_path(booking), class:"btn btn-danger", data: {turbo_method: :delete, turbo_confirm: "Are you sure?"} %>
          <% if (booking.end_time < Time.now && booking.review.nil?) %>
            <%= link_to "Write a Review", new_booking_review_path(booking), class: "btn btn-primary" %>
          <% end %>
      </div>
    <% end %>
</div>
